(function(i,c){typeof exports=="object"&&typeof module!="undefined"?module.exports=c():typeof define=="function"&&define.amd?define(c):(i=typeof globalThis!="undefined"?globalThis:i||self,i.JSMasker=c())})(this,(function(){"use strict";function i(n,y,o,a="*"){let u=n;return u==="random"&&(u=Math.floor(Math.random()*(o-y+1))+y),a.repeat(u)}function c(n){return n.toLowerCase().replace(/[^a-z0-9]/g,"")}function j(n,y={},o=new WeakMap){const{properties:a=["password","key","secret","token","privatekey","passphrase"],propertyMatcher:u=null,maskLength:w=8,minLength:x=5,maxLength:z=15,maskChar:M="*",fullMask:g=!1}=y;if(o.has(n))return o.get(n);const A=a.map(e=>c(e));function O(e){return typeof g=="string"?g:g===!0?M.repeat(e.length):i(w,x,z,M)}function b(e,s,t=[]){const r=c(e);return u&&typeof u=="function"?u(e,r,s,t):A.indexOf(r)!==-1}function k(e,s,t=[]){if(e==null)return e;if(typeof e=="object"&&o.has(e))return o.get(e);let r;if(Array.isArray(e)){r=[],o.set(e,r);for(let l=0;l<e.length;l+=1){const p=[...t,l];r[l]=k(e[l],s,p)}}else if(typeof e=="object"){r={},o.set(e,r);const l=Object.keys(e);for(let p=0;p<l.length;p+=1){const h=l[p],d=[...t,h],L=s||b(h,e[h],d);r[h]=k(e[h],L,d)}}else s&&typeof e=="string"?r=O(e):r=e;return r}let f;if(Array.isArray(n)){f=[],o.set(n,f);for(let e=0;e<n.length;e+=1)f[e]=k(n[e],!1,[e])}else if(n&&typeof n=="object"){f={},o.set(n,f);const e=Object.keys(n);for(let s=0;s<e.length;s+=1){const t=e[s],r=b(t,n[t],[t]);f[t]=k(n[t],r,[t])}}else f=n;return f}return j}));
