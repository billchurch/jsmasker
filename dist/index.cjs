"use strict";function L(r,h,s,k="*"){let u=r;return u==="random"&&(u=Math.floor(Math.random()*(s-h+1))+h),k.repeat(u)}function b(r){return r.toLowerCase().replace(/[^a-z0-9]/g,"")}function P(r,h={},s=new WeakMap){const{properties:k=["password","key","secret","token","privatekey","passphrase"],propertyMatcher:u=null,maskLength:j=8,minLength:w=5,maxLength:z=15,maskChar:i="*",fullMask:a=!1}=h;if(s.has(r))return s.get(r);const A=k.map(e=>b(e));function O(e){return typeof a=="string"?a:a===!0?i.repeat(e.length):L(j,w,z,i)}function g(e,o,n=[]){const t=b(e);return u&&typeof u=="function"?u(e,t,o,n):A.indexOf(t)!==-1}function y(e,o,n=[]){if(e==null)return e;if(typeof e=="object"&&s.has(e))return s.get(e);let t;if(Array.isArray(e)){t=[],s.set(e,t);for(let f=0;f<e.length;f+=1){const c=[...n,f];t[f]=y(e[f],o,c)}}else if(typeof e=="object"){t={},s.set(e,t);const f=Object.keys(e);for(let c=0;c<f.length;c+=1){const p=f[c],M=[...n,p],x=o||g(p,e[p],M);t[p]=y(e[p],x,M)}}else o&&typeof e=="string"?t=O(e):t=e;return t}let l;if(Array.isArray(r)){l=[],s.set(r,l);for(let e=0;e<r.length;e+=1)l[e]=y(r[e],!1,[e])}else if(r&&typeof r=="object"){l={},s.set(r,l);const e=Object.keys(r);for(let o=0;o<e.length;o+=1){const n=e[o],t=g(n,r[n],[n]);l[n]=y(r[n],t,[n])}}else l=r;return l}module.exports=P;
